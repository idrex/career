<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.svg" />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.2
    </script>
    <title>模块化标准</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/">Drex</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/guide">指南</a><a aria-current="page" class="active" href="/fontend">前端</a><a href="/backend">后端</a><a href="/devops">运维</a><a href="/blog">博客</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/"></a><h1>Drex</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/guide">指南</a></li><li><a aria-current="page" class="active" href="/fontend">前端</a></li><li><a href="/backend">后端</a></li><li><a href="/devops">运维</a></li><li><a href="/blog">博客</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/fontend">前端体系图</a></li><li><a href="/fontend/browser">浏览器</a><ul><li><a href="/fontend/browser/basic"><span>基础知识</span></a></li><li><a href="/fontend/browser/model"><span>浏览器模型</span></a></li><li><a href="/fontend/browser/optimization"><span>性能优化</span></a></li><li><a href="/fontend/browser/request"><span>网络请求</span></a></li></ul></li><li><a href="/fontend/html">Html</a><ul><li><a href="/fontend/html/basic"><span>基础知识</span></a></li></ul></li><li><a href="/fontend/css">CSS</a><ul><li><a href="/fontend/css/basic"><span>基础知识</span></a></li><li><a href="/fontend/css/less"><span>Less</span></a></li></ul></li><li><a href="/fontend/javasrcipt">Javasrcipt</a><ul><li><a href="/fontend/javasrcipt/basic"><span>基础中的基础</span></a></li><li><a href="/fontend/javasrcipt/application"><span>基础应用</span></a></li><li><a href="/fontend/javasrcipt/esnext"><span>ES6 &amp; ES Next</span></a></li><li><a href="/fontend/javasrcipt/ts"><span>TypeScript</span></a></li><li><a href="/fontend/javasrcipt/issues"><span>JS 相关方法实现</span></a></li><li><a href="/fontend/javasrcipt/optimization"><span>代码优化技巧</span></a></li></ul></li><li><a href="/fontend/construct">构建工具</a><ul><li><a href="/fontend/construct/webpack"><span>Webpack</span></a></li></ul></li><li><a href="/fontend/frame">JS 框架</a><ul><li><a href="/fontend/frame/react"><span>React</span></a></li><li><a href="/fontend/frame/redux"><span>Redux</span></a></li><li><a href="/fontend/frame/vue"><span>Vue</span></a></li></ul></li><li><a href="/fontend/mobile">移动&amp;桌面应用</a><ul><li><a href="/fontend/mobile/certificate"><span>证书说明</span></a></li><li><a href="/fontend/mobile/hybrid"><span>Hybrid APP</span></a></li><li><a href="/fontend/mobile/react-native"><span>React Native</span></a></li></ul></li><li><a href="/fontend/setup">工程体系</a><ul><li><a href="/fontend/setup/pattern"><span>体系格局</span></a></li><li><a href="/fontend/setup/engineering"><span>前端工程化</span></a></li></ul></li><li><a aria-current="page" class="active" href="/fontend/package">Package</a><ul><li><a aria-current="page" class="active" href="/fontend/package/module"><span>模块化标准</span></a></li><li><a href="/fontend/package/npm"><span>Npm</span></a></li><li><a href="/fontend/package/yarn"><span>Yarn</span></a></li></ul></li><li><a href="/fontend/security">Security</a><ul><li><a href="/fontend/security/monitor"><span>监控体系</span></a></li><li><a href="/fontend/security/web"><span>Web 安全</span></a></li></ul></li><li><a href="/fontend/visual">Visual</a><ul><li><a href="/fontend/visual/map"><span>Map 地图组建</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="JS-模块化进程" data-depth="2" class=""><a href="/fontend/package/module#js-模块化进程"><span>JS-模块化进程</span></a></li><li title="原始的开发方式" data-depth="2" class=""><a href="/fontend/package/module#原始的开发方式"><span>原始的开发方式</span></a></li><li title="CommonJS &amp;&amp; node.js" data-depth="2" class=""><a href="/fontend/package/module#commonjs--nodejs"><span>CommonJS &amp;&amp; node.js</span></a></li><li title="AMD &amp;&amp; Require.js" data-depth="2" class=""><a href="/fontend/package/module#amd--requirejs"><span>AMD &amp;&amp; Require.js</span></a></li><li title="CMD &amp;&amp; Sea.js" data-depth="2" class=""><a href="/fontend/package/module#cmd--seajs"><span>CMD &amp;&amp; Sea.js</span></a></li><li title="UMD &amp;&amp; webpack" data-depth="2" class=""><a href="/fontend/package/module#umd--webpack"><span>UMD &amp;&amp; webpack</span></a></li><li title="ES6 Module &amp;&amp; ES6" data-depth="2" class=""><a href="/fontend/package/module#es6-module--es6"><span>ES6 Module &amp;&amp; ES6</span></a></li><li title="ES6 对比 CommonJS" data-depth="2" class=""><a href="/fontend/package/module#es6-对比-commonjs"><span>ES6 对比 CommonJS</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="模块化标准"><a aria-hidden="true" href="#模块化标准"><span class="icon icon-link"></span></a>模块化标准</h1><h2 id="js-模块化进程"><a aria-hidden="true" href="#js-模块化进程"><span class="icon icon-link"></span></a>JS-模块化进程</h2><p>随着 js 技术的不断发展，途中会遇到各种问题，比如模块化。</p><p>那什么是模块化呢,他们的目的是什么？</p><p>定义：如何把一段代码封装成一个有用的单元，以及如何注册此模块的能力、输出的值依赖引用：如何引用其它代码单元</p><p>到目前为止，大概分为以下几个里程碑式阶段。</p><blockquote><p>原始的开发方式 ---&gt; CommonJS ---&gt; AMD ---&gt; CMD ---&gt; UMD ---&gt; ES6Module</p></blockquote><h2 id="原始的开发方式"><a aria-hidden="true" href="#原始的开发方式"><span class="icon icon-link"></span></a>原始的开发方式</h2><p>最开始的时候，JS 自身是没有模块机制的。项目有多个 js 文件。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// a.js
function foo() {}
// b.js
function bar() {}
// c.js
foo();
" data-status="copy"></button><div class="token-line"><span class="token comment">// a.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// b.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// c.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>HTML 加载</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;script src=&quot;a.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;b.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;c.js&quot;&gt;&lt;/script&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">a.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">b.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">c.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>原始的开发方式，随着项目的复杂度，代码量越来越多，所需要加载的文件也越来越多，这个时候，就要考虑几个问题了：</p><ul><li>命名问题：所有文件的方法都是挂载到 global 上，会污染全局环境，并且需要考虑命名冲突问题。</li><li>依赖问题：script 是顺序加载的，如果各文件之间有依赖，那我们得考虑加载.js 文件的书写顺序。</li><li>网络问题。如果文件过多，所需请求次数会增多，增加加载时间。</li></ul><h2 id="commonjs--nodejs"><a aria-hidden="true" href="#commonjs--nodejs"><span class="icon icon-link"></span></a>CommonJS &amp;&amp; node.js</h2><p>CommonJS 规范，主要运行于服务器端，同步加载模块，而加载的文件资源大多数在本地服务器，所以执行速度或时间没问题。Node.js 很好的实现了该规范。该规范指出，一个单独的文件就是一个模块。模块功能主要的几个命令：require 和 module.exports。require 命令用于输入其他模块提供的功能，module.exports 命令用于规范模块的对外接口，输出的是一个值的拷贝，输出之后就不能改变了，会缓存起来。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// moduleA.js
var name = &quot;Drex&quot;;
function foo() {}

module.exports = exports = {
  name,
  foo,
};

// moduleB.js
var ma = require(&quot;./moduleA&quot;); // 可以省略后缀.js
exports.bar = function() {
  ma.name === &quot;Drex&quot;; // true
  ma.foo(); // 执行foo方法
};

// moduleC.js
var mb = require(&quot;./moduleB&quot;);
mb.bar();
" data-status="copy"></button><div class="token-line"><span class="token comment">// moduleA.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&quot;Drex&quot;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> exports </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  name</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  foo</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// moduleB.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> ma </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./moduleA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 可以省略后缀.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">exports</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">bar</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  ma</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&quot;Drex&quot;</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// true</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  ma</span><span class="token punctuation">.</span><span class="token method function property-access">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 执行foo方法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// moduleC.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> mb </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./moduleB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">mb</span><span class="token punctuation">.</span><span class="token method function property-access">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>通过例子，我们可以看出 require(moduleId)来加载其他模块的内容，其返回值就是其引用的外部模块所暴露的 API，之后再通过 module.exports 或者 exports 来为当前模块的方法和变量提供输出接口。</p><p>最后通过 node 来执行模块。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="(function(exports, require, module, __filename, __dirname) {
    // module: 表示当前模块
    // __filename: 当前模块的带有完整绝对路径的文件名
    // __dirname: 当前模块的完整绝对路径
    module.exports = exports = this = {};
    // 我们的代码就在这里...
    return module.exports;
})()

" data-status="copy"></button><div class="token-line"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token parameter punctuation">,</span><span class="token parameter"> require</span><span class="token parameter punctuation">,</span><span class="token parameter"> module</span><span class="token parameter punctuation">,</span><span class="token parameter"> __filename</span><span class="token parameter punctuation">,</span><span class="token parameter"> __dirname</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// module: 表示当前模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// __filename: 当前模块的带有完整绝对路径的文件名</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// __dirname: 当前模块的完整绝对路径</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> exports </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 我们的代码就在这里...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="amd--requirejs"><a aria-hidden="true" href="#amd--requirejs"><span class="icon icon-link"></span></a>AMD &amp;&amp; Require.js</h2><p>AMD(Asynchronous Module Definition - 异步加载模块定义)规范，制定了定义模块的规则,一个单独的文件就是一个模块，模块和模块的依赖可以被异步加载。主要运行于浏览器端，这和浏览器的异步加载模块的环境刚好适应，它不会影响后面语句的运行。该规范是在 RequireJs 的推广过程中逐渐完善的。</p><p>模块功能主要的几个命令：define、require、return 和 define.amd。define 是全局函数，用来定义模块,define(id?, dependencies?, factory)。require 命令用于输入其他模块提供的功能，return 命令用于规范模块的对外接口，define.amd 属性是一个对象，此属性的存在来表明函数遵循 AMD 规范。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// moduleA.js
define([&#x27;jQuery&#x27;,&#x27;lodash&#x27;], function(\$, \_) {
var name = &#x27;Drex&#x27;,
function foo() {}
return {
name,
foo
}
})

// index.js
require([&#x27;moduleA&#x27;], function(a) {
a.name === &#x27;Drex&#x27; // true
a.foo() // 执行 A 模块中的 foo 函数
// do sth...
})

// index.html

&lt;script src=&quot;js/require.js&quot; data-main=&quot;js/index&quot;&gt;&lt;/script&gt;
" data-status="copy"></button><div class="token-line"><span class="token comment">// moduleA.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;jQuery&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;lodash&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">\$</span><span class="token parameter punctuation">,</span><span class="token parameter"> \_</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;Drex&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">name</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">foo</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// index.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;moduleA&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&#x27;Drex&#x27;</span><span class="token plain"> </span><span class="token comment">// true</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token punctuation">.</span><span class="token method function property-access">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment">// 执行 A 模块中的 foo 函数</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// do sth...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// index.html</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">script src</span><span class="token operator">=</span><span class="token string">&quot;js/require.js&quot;</span><span class="token plain"> data</span><span class="token operator">-</span><span class="token plain">main</span><span class="token operator">=</span><span class="token string">&quot;js/index&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">script</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>在这里，我们使用 define 来定义模块，return 来输出接口， require 来加载模块，这是 AMD 官方推荐用法。当然也可以使用其他兼容性的写法，比如对 Simplified CommonJS Wrapper 格式的支持，但背后还是原始 AMD 的运行逻辑。AMD 的运行逻辑是：提前加载，提前执行。在 Requirejs 中，申明依赖模块时，会第一时间加载并执行模块内的代码，使后面的回调函数能在所需的环境中运行。为了更好地优化请求，同时推出了打包工具 r.js，使所需加载的文件数减少。require.js 模块化开发，并用 r.js 打包例子</p><h2 id="cmd--seajs"><a aria-hidden="true" href="#cmd--seajs"><span class="icon icon-link"></span></a>CMD &amp;&amp; Sea.js</h2><p>CMD(Common Module Definition - 通用模块定义)规范主要是 Sea.js 推广中形成的，一个文件就是一个模块，可以像 Node.js 一般书写模块代码。主要在浏览器中运行，当然也可以在 Node.js 中运行。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// moduleA.js
// 定义模块
define(function(require, exports, module) {
var func = function() {
var a = require(&#x27;./a&#x27;) // 到此才会加载 a 模块
a.func()
if(false) {
var b = require(&#x27;./b&#x27;) // 到此才会加载 b 模块
b.func()
}
}
// do sth...
exports.func = func;
})

// index.js
// 加载使用模块
seajs.use(&#x27;moduleA.js&#x27;, function(ma) {
var ma = math.func()
})

// HTML，需要在页面中引入 sea.js 文件。

&lt;script src=&quot;./js/sea.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;./js/index.js&quot;&gt;&lt;/script&gt;
" data-status="copy"></button><div class="token-line"><span class="token comment">// moduleA.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 定义模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token parameter punctuation">,</span><span class="token parameter"> exports</span><span class="token parameter punctuation">,</span><span class="token parameter"> module</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> </span><span class="token function-variable function">func</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> a </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./a&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment">// 到此才会加载 a 模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token punctuation">.</span><span class="token method function property-access">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> b </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./b&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment">// 到此才会加载 b 模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token punctuation">.</span><span class="token method function property-access">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// do sth...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">exports</span><span class="token punctuation">.</span><span class="token property-access">func</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> func</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// index.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 加载使用模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">seajs</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">&#x27;moduleA.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ma</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> ma </span><span class="token operator">=</span><span class="token plain"> math</span><span class="token punctuation">.</span><span class="token method function property-access">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// HTML，需要在页面中引入 sea.js 文件。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">script src</span><span class="token operator">=</span><span class="token string">&quot;./js/sea.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">script</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">script src</span><span class="token operator">=</span><span class="token string">&quot;./js/index.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">script</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>这里 <code>define</code> 是一个全局函数，用来定义模块，并通过 <code>exports</code> 向外提供接口。之后，如果要使用某模块，可以通过 require 来获取该模块提供的接口。最后使用某个组件的时候，通过 <code>seajs.use()</code>来调用。</p><p>通过 <code>exports</code> 暴露接口。这意味着不需要命名空间了，更不需要全局变量。通过 <code>require</code> 引入依赖。这可以让依赖内置，我们只需要关心当前模块的依赖。关注度分离 CMD 推崇依赖就近，延迟执行。在上面例子中，通过 <code>require</code> 引入的模块，只有当程序运行到此处的时候，模块才会自动加载执行。</p><p>同时推出了 <code>spm(static package manager)</code>的打包方式，听说支付宝的项目在使用。</p><h2 id="umd--webpack"><a aria-hidden="true" href="#umd--webpack"><span class="icon icon-link"></span></a>UMD &amp;&amp; webpack</h2><p><code>UMD</code>(<code>Universal Module Definition</code> - 通用模块定义)模式，该模式主要用来解决 <code>CommonJS</code> 模式和 <code>AMD</code> 模式代码不能通用的问题，并同时还支持老式的全局变量规范。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 使用 Node, AMD 或 browser globals 模式创建模块
(function(root, factory) {
  if (typeof define === &quot;function&quot; &amp;&amp; define.amd) {
    // AMD 模式. 注册为一个匿名函数
    define([&quot;b&quot;], factory);
  } else if (typeof module === &quot;object&quot; &amp;&amp; module.exports) {
    // Node 等类 CommonJS 的环境
    module.exports = factory(require(&quot;b&quot;));
  } else {
    // 浏览器全局变量 (root is window)
    root.returnExports = factory(root.b);
  }
})(typeof self !== &quot;undefined&quot; ? self : this, function(b) {
  // 以某种方式使用 b

  //返回一个值来定义模块导出。(即可以返回对象，也可以返回函数)
  return {};
});
" data-status="copy"></button><div class="token-line"><span class="token comment">// 使用 Node, AMD 或 browser globals 模式创建模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token parameter punctuation">,</span><span class="token parameter"> factory</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token plain"> define </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&quot;function&quot;</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> define</span><span class="token punctuation">.</span><span class="token property-access">amd</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// AMD 模式. 注册为一个匿名函数</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> factory</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token plain"> module </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&quot;object&quot;</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// Node 等类 CommonJS 的环境</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 浏览器全局变量 (root is window)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    root</span><span class="token punctuation">.</span><span class="token property-access">returnExports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token plain">root</span><span class="token punctuation">.</span><span class="token property-access">b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token plain"> self </span><span class="token operator">!==</span><span class="token plain"> </span><span class="token string">&quot;undefined&quot;</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> self </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 以某种方式使用 b</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//返回一个值来定义模块导出。(即可以返回对象，也可以返回函数)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>判断 <code>define</code> 为函数，并且是否存在 <code>define.amd</code>，来判断是否为 <code>AMD</code> 规范,判断 <code>module</code> 是否为一个对象，并且是否存在 <code>module.exports</code> 来判断是否为 <code>CommonJS</code> 规范如果以上两种都没有，设定为原始的代码规范。这种模式，通常会在 <code>webpack</code> 打包的时候用到。<code>output.libraryTarget</code> 将模块以哪种规范的文件输出。</p><h2 id="es6-module--es6"><a aria-hidden="true" href="#es6-module--es6"><span class="icon icon-link"></span></a>ES6 Module &amp;&amp; ES6</h2><p>在 <code>ECMAScript 2015</code> 版本出来之后，确定了一种新的模块加载方式，我们称之为 <code>ES6 Module</code>。它和前几种方式有区别和相同点。</p><p>它因为是标准，所以未来很多浏览器会支持，可以很方便的在浏览器中使用。它同时兼容在 node 环境下运行。模块的导入导出，通过 <code>import</code> 和 <code>export</code> 来确定。可以和 <code>Commonjs</code> 模块混合使用。<code>CommonJS</code> 输出的是一个值的拷贝。ES6 模块输出的是值的引用,加载的时候会做静态优化。<code>CommonJS</code> 模块是运行时加载确定输出接口，<code>ES6</code> 模块是编译时确定输出接口。<code>ES6</code> 模块功能主要由两个命令构成：<code>import</code> 和 <code>export</code>。<code>import</code> 命令用于输入其他模块提供的功能。<code>export</code> 命令用于规范模块的对外接口。</p><p>export 的几种用法</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 输出变量
export var name = &#x27;Drex&#x27;
export var year = &#x27;2020&#x27;

// 输出一个对象（推荐）
var name = &#x27;Drex&#x27;
var year = &#x27;2020&#x27;
export { name, year}

// 输出函数或类
export function add(a, b) {
return a + b;
}

// export default 命令
export default function() {
console.log(&#x27;foo&#x27;)
}
import 导入其他模块

// 正常命令
import { name, year } from &#x27;./module.js&#x27; //后缀.js 不能省略

// 如果遇到 export default 命令导出的模块
import ed from &#x27;./export-default.js&#x27;
" data-status="copy"></button><div class="token-line"><span class="token comment">// 输出变量</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">var</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;Drex&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">var</span><span class="token plain"> year </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;2020&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 输出一个对象（推荐）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;Drex&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> year </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;2020&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">,</span><span class="token plain"> year</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 输出函数或类</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token parameter punctuation">,</span><span class="token parameter"> b</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">return</span><span class="token plain"> a </span><span class="token operator">+</span><span class="token plain"> b</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// export default 命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> 导入其他模块</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 正常命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">,</span><span class="token plain"> year </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;./module.js&#x27;</span><span class="token plain"> </span><span class="token comment">//后缀.js 不能省略</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 如果遇到 export default 命令导出的模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> ed </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;./export-default.js&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>模块编辑好之后，它可以以多种形式加载。</p><ol><li>浏览器加载 浏览器加载 <code>ES6</code> 模块，使用 <code>&lt;script&gt;</code> 标签，但是要加入 <code>type=&quot;module&quot;</code>属性外链 <code>js</code> 文件</li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;script type=&quot;module&quot; src=&quot;index.js&quot;&gt;&lt;/script&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">module</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">index.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>也可以内嵌在网页中</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;script type=&quot;module&quot;&gt;
  import utils from &quot;./utils.js&quot;;
  // other code
&lt;/script&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">module</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword module">import</span><span class="token script language-javascript"> utils </span><span class="token script language-javascript keyword module">from</span><span class="token script language-javascript"> </span><span class="token script language-javascript string">&quot;./utils.js&quot;</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript"></span></div><div class="token-line"><span class="token script language-javascript">  </span><span class="token script language-javascript comment">// other code</span><span class="token script language-javascript"></span></div><div class="token-line"><span class="token script language-javascript"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>对于加载外部模块，需要注意：</p><p>代码是在模块作用域之中运行，而不是在全局作用域运行。模块内部的顶层变量，外部不可见。模块脚本自动采用严格模式，不管有没有声明 <code>use strict</code>。模块之中，可以使用 <code>import</code> 命令加载其他模块（<code>.js</code> 后缀不可省略，需要提供绝对 <code>URL</code> 或相对 <code>URL</code>），也可以使用 <code>export</code> 命令输出对外接口。模块之中，顶层的 <code>this</code> 关键字返回 <code>undefined</code>，而不是指向 <code>window</code>。也就是说，在模块顶层使用 <code>this</code> 关键字，是无意义的。同一个模块如果加载多次，将只执行一次。</p><ol start="2"><li><code>Node</code> 加载<code>Node</code> 要求 <code>ES6</code> 模块采用<code>.mjs</code> 后缀文件名。也就是说，只要脚本文件里面使用 <code>import</code> 或者 <code>export</code> 命令，就必须采用<code>.mjs</code> 后缀名。这个功能还在试验阶段。安装 <code>Node V8.5.0</code> 或以上版本，要用<code>--experimental-modules</code> 参数才能打开该功能。</li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ node --experimental-modules my-app.mjs
" data-status="copy"></button><div class="token-line"><span class="token plain">$ node --experimental-modules my-app.mjs</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>Node</code> 的 <code>import</code> 命令只支持异步加载本地模块(file:协议)，不支持加载远程模块。</p><h2 id="es6-对比-commonjs"><a aria-hidden="true" href="#es6-对比-commonjs"><span class="icon icon-link"></span></a>ES6 对比 CommonJS</h2><table><thead><tr><th>对比</th><th>es6</th><th>commonJS</th></tr></thead><tbody><tr><td>输入</td><td><code>import *** from ***</code>进行引入</td><td><code>var *** = require(&#x27;***&#x27;)</code>进行引入</td></tr><tr><td>输出</td><td><code>export</code> 可以输出多个，输出方式为 <code>{}</code></td><td><code>exports.</code> 可以输出多个</td></tr><tr><td></td><td><code>export default</code> 只能输出一个 ，可以与export 同时输出，但是不建议这么做</td><td><code>module.exports=...</code> 只能输出一个，且后面的会覆盖上面的</td></tr><tr><td></td><td>静态分析，动态引用，输出的是值的引用，值改变，引用也改变，即原来模块中的值改变则该加载的值也改变</td><td>输出是值的拷贝，即原来模块中的值改变不会影响已经加载的该值</td></tr><tr><td>接口</td><td>解析阶段确定对外输出的接口，解析阶段生成接口</td><td>运行阶段确定接口，运行时才会加载模块</td></tr><tr><td>模块</td><td>模块不是对象，加载的不是对象</td><td>模块是对象，加载的是该对象</td></tr><tr><td>加载</td><td>可以单独加载其中的某个接口（方法）</td><td>加载的是整个模块，即将所有的接口全部加载进来</td></tr><tr><td>循环引用</td><td>ES6模块是动态引用。只要两个模块之间存在某个引用，代码就能够执行</td><td>脚本代码在require的时候，就会全部执行。一旦出现某个模块被&quot;循环加载&quot;，就只输出已经执行的部分，还未执行的部分不会输出。</td></tr><tr><td>this</td><td>this 指向undefined</td><td>this 指向当前模块</td></tr></tbody></table><p>参考<a href="https://mp.weixin.qq.com/s/TMmuAKWkOqWlwPB56Ff02A" target="_blank" rel="noopener noreferrer">Node 中如何引入一个模块及其细节<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last Update: ">12/15/2020, 11:21:47 PM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
