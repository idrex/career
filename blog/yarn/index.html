<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.svg" />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.2.28
    </script>
    <title>yarn vs npm vs cnpm</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/">Drex</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/guide">指南</a><a href="/fontend">前端</a><a href="/backend">后端</a><a href="/devops">运维</a><a aria-current="page" class="active" href="/blog">博客</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/"></a><h1>Drex</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/guide">指南</a></li><li><a href="/fontend">前端</a></li><li><a href="/backend">后端</a></li><li><a href="/devops">运维</a></li><li><a aria-current="page" class="active" href="/blog">博客</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/blog">推荐网站</a></li><li><a href="/blog/ffmpeg">ffmpeg 下载 ts 文件视频</a></li><li><a href="/blog/lighthouse网站检测">Lighthouse 网站检测</a></li><li><a href="/blog/rbac权限管理">RBAC权限管理(Resource-Based Access Control)</a></li><li><a href="/blog/record">备案相关</a></li><li><a href="/blog/video">音视频</a></li><li><a href="/blog/website">网站性能测试指标</a></li><li><a aria-current="page" class="active" href="/blog/yarn">yarn vs npm vs cnpm</a></li><li><a href="/blog/可变(mutable)和不变(immutable)对象的区别">可变(Mutable)和不变(Immutable)对象的区别</a></li><li><a href="/blog/知识产权">知识产权</a></li><li><a href="/blog/系统相关">系统相关</a></li><li><a href="/blog/网站克隆机 httrack">网站克隆机 HTTrack</a></li><li><a href="/blog/部署egg应用到docker">部署egg应用到docker</a></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="说明" data-depth="3" class=""><a href="/blog/yarn#说明"><span>说明</span></a></li><li title="自动配置npm及yarn源[推荐]" data-depth="3" class=""><a href="/blog/yarn#自动配置npm及yarn源推荐"><span>自动配置npm及yarn源[推荐]</span></a></li><li title="手动配置淘宝源" data-depth="3" class=""><a href="/blog/yarn#手动配置淘宝源"><span>手动配置淘宝源</span></a></li><li title="手动配置node-sass源" data-depth="3" class=""><a href="/blog/yarn#手动配置node-sass源"><span>手动配置node-sass源</span></a></li><li title="更多请参考" data-depth="3" class=""><a href="/blog/yarn#更多请参考"><span>更多请参考</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><p>测试均采用公司网络，网速极好时进行。taoche项目。网络有限制时npm安装成功率较低。</p><table><thead><tr><th></th><th>npm v3.x</th><th>npm v5.x</th><th>cnpm(5.x)</th><th>yarn</th></tr></thead><tbody><tr><td>是否锁依赖版本</td><td>否(手动)</td><td>是</td><td>否(手动)</td><td>是</td></tr><tr><td>版本锁文件</td><td>无</td><td>package-lock.json</td><td>无</td><td>yarn.lock</td></tr><tr><td>版本锁机制</td><td>无</td><td>package-lock.json优先</td><td>无</td><td>yarn.lock优先</td></tr><tr><td>安装依赖速度</td><td>极慢</td><td>慢</td><td>极快</td><td>快</td></tr><tr><td>依赖目录结构</td><td>平铺</td><td>平铺</td><td>软链</td><td>平铺</td></tr><tr><td>初次安装(非淘宝源)</td><td>failed</td><td>failed</td><td>34s</td><td>failed</td></tr><tr><td>初次安装(node-sass源)</td><td>11m+</td><td>5m56s</td><td>34s</td><td>66s</td></tr><tr><td>重复安装</td><td>2m+</td><td>25s</td><td>19s</td><td>24s</td></tr><tr><td>项目兼容性</td><td>好</td><td>好</td><td>差</td><td>好</td></tr><tr><td>是否可更新依赖</td><td>手动</td><td>手动</td><td>否</td><td>是</td></tr></tbody></table><h3 id="说明"><a aria-hidden="true" href="#说明"><span class="icon icon-link"></span></a>说明</h3><ul><li>完全使用<code>cnpm</code>会有以下问题:<ul><li>本地项目构建会将vue/react等dll模块构建进去</li><li>公司内部模块升级需要手动删除node_modules下模块目录和软链接，重新cnpm</li></ul></li><li><code>node-sass</code> 依赖包在不配源的情况下，非cnpm版本都极容易安装不了failed</li><li>版本锁定机制的不同，导致npm5.x一旦安装需要手动升级，才能更新lock文件, yarn执行后会同步当前package.json到yarn.lock并更换为与package.json中不同的依赖包</li></ul><h3 id="自动配置npm及yarn源推荐"><a aria-hidden="true" href="#自动配置npm及yarn源推荐"><span class="icon icon-link"></span></a>自动配置npm及yarn源[推荐]</h3><p>将如下代码在命令行中执行(不支持windows cmd)</p><p><code>curl -s http://git.taoche.com/npm/install_env/raw/master/install.sh | sh</code></p><h3 id="手动配置淘宝源"><a aria-hidden="true" href="#手动配置淘宝源"><span class="icon icon-link"></span></a>手动配置淘宝源</h3><p>yarn:</p><p><code>yarn config set registry https://registry.npm.taobao.org</code></p><p>npm:</p><p><code>npm config set registry https://registry.npm.taobao.org </code></p><h3 id="手动配置node-sass源"><a aria-hidden="true" href="#手动配置node-sass源"><span class="icon icon-link"></span></a>手动配置node-sass源</h3><p>yarn:</p><p><code>yarn config set sass_binary_site http://cdn.npm.taobao.org/dist/node-sass</code></p><p>npm:</p><p><code>npm config set sass-binary-site http://cdn.npm.taobao.org/dist/node-sass</code></p><p>npm 与 yarn 常用命令对比 检查依赖是否可更新 npm outdated [-g] yarn [global] outdated 更新依赖包到最新版本 npm update [-g] yarn [global] upgrade 锁定依赖包版本号（生成 npm-shrinkwrap.json 文件） npm shrinkwrap yarn generate-lock-entry &amp;&amp; yarn install 固定依赖包版本号（修改 package.json 文件） npm config set save-prefix=&quot;~&quot; npm config set save-exact true 线上环境更新依赖包（仅安装 dependencies 里面的包） npm install --production yarn install --production 安装 package.json 中所有依赖 npm install yarn install 安装生产依赖（指定版本） npm install --save lodash@4.17.2 yarn add lodash@4.17.2 安装开发依赖（指定版本） npm install --save-dev lodash@4.17.2 yarn add lodash@4.17.2 --dev 安装全局依赖（指定版本） npm install --global lodash@4.17.2 yarn global add lodash@4.17.2 卸载生产依赖 npm uninstall --save lodash yarn remove lodash 卸载开发依赖 npm uninstall --save-dev lodash -yarn remove lodash --dev 更新生产依赖 npm update --save yarn upgrade 升级全局依赖到最新版本 npm update lodash -g yarn global upgrade webpack 查看全局依赖包 npm ls -g</p><h3 id="更多请参考"><a aria-hidden="true" href="#更多请参考"><span class="icon icon-link"></span></a>更多请参考</h3><p><a href="https://sebastianblade.com/the-truly-way-to-install-upgrade-npm-dependency-in-china/" target="_blank" rel="noopener noreferrer">https://sebastianblade.com/the-truly-way-to-install-upgrade-npm-dependency-in-china/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last Update: ">11/27/2020, 9:47:03 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
