<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.svg" />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.2.13
    </script>
    <title>Docker</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/">Drex</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/guide">指南</a><a href="/fontend">前端</a><a href="/backend">后端</a><a aria-current="page" class="active" href="/devops">运维</a><a href="/blog">博客</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.svg&#x27;)" href="/"></a><h1>Drex</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/guide">指南</a></li><li><a href="/fontend">前端</a></li><li><a href="/backend">后端</a></li><li><a aria-current="page" class="active" href="/devops">运维</a></li><li><a href="/blog">博客</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/idrex/career">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/devops">运维体系图</a></li><li><a href="/devops/system">OS系统</a><ul><li><a href="/devops/system/linux"><span>Linux</span></a></li><li><a href="/devops/system/centos"><span>CentOS</span></a></li></ul></li><li><a aria-current="page" class="active" href="/devops/cloudnative">云原生</a><ul><li><a aria-current="page" class="active" href="/devops/cloudnative/docker"><span>Docker</span></a></li></ul></li><li><a href="/devops/serverless">Serverless</a><ul><li><a href="/devops/serverless/tentcent"><span>腾讯云Serverless</span></a></li><li><a href="/devops/serverless/ali"><span>阿里云Faas</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="简介" data-depth="2" class=""><a href="/devops/cloudnative/docker#简介"><span>简介</span></a></li><li title="传统物理机及虚拟机" data-depth="3" class=""><a href="/devops/cloudnative/docker#传统物理机及虚拟机"><span>传统物理机及虚拟机</span></a></li><li title="Linux 容器" data-depth="3" class=""><a href="/devops/cloudnative/docker#linux-容器"><span>Linux 容器</span></a></li><li title="概念" data-depth="2" class=""><a href="/devops/cloudnative/docker#概念"><span>概念</span></a></li><li title="镜像 (Image)" data-depth="3" class=""><a href="/devops/cloudnative/docker#镜像-image"><span>镜像 (Image)</span></a></li><li title="容器 (Container)" data-depth="3" class=""><a href="/devops/cloudnative/docker#容器-container"><span>容器 (Container)</span></a></li><li title="仓库 (Repository)" data-depth="3" class=""><a href="/devops/cloudnative/docker#仓库-repository"><span>仓库 (Repository)</span></a></li><li title="环境安装" data-depth="2" class=""><a href="/devops/cloudnative/docker#环境安装"><span>环境安装</span></a></li><li title="CentOS安装" data-depth="3" class=""><a href="/devops/cloudnative/docker#centos安装"><span>CentOS安装</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h2 id="简介"><a aria-hidden="true" href="#简介"><span class="icon icon-link"></span></a>简介</h2><p><code>Docker</code>，是一款现在最流行的 软件容器平台，提供了软件运行时所依赖的环境。</p><h3 id="传统物理机及虚拟机"><a aria-hidden="true" href="#传统物理机及虚拟机"><span class="icon icon-link"></span></a>传统物理机及虚拟机</h3><ul><li><p><strong>物理机</strong>: - 硬件环境，真实的 <strong>计算机实体</strong>，包含了例如物理内存，硬盘等等硬件；</p></li><li><p><strong>虚拟机</strong>: - 在物理机上 <strong>模拟出一套硬件环境和操作系统</strong>，应用软件可以运行于其中，并且毫无感知，是一套<strong>隔离的完整环境</strong>。本质上，它只是物理机上的一份 <strong>运行文件</strong>。</p></li><li><p><strong>为什么需要虚拟机？</strong>- <strong>环境配置与迁移</strong>: - 在软件开发和运行中，环境依赖一直是一个很头疼的难题，比如你想运行 node 应用，那至少环境得安装 node 吧，而且不同版本，不同系统都会影响运行。<strong>解决的办法</strong>，就是我们的包装包中直接包含运行环境的安装，让同一份环境可以快速复制到任意一台物理机上。 - <strong>资源利用率与隔离</strong>: - 通过硬件模拟，并包含一套完整的操作系统，应用可以独立运行在虚拟机中，与外界隔离。并且可以在同一台物理机上，开启多个不同的虚拟机启动服务，即一台服务器，提供多套服务，且资源完全相互隔离，互不影响。不仅能更好提高资源利用率率，降低成本，而且也有利于服务的稳定性。</p></li><li><p><strong>传统虚拟机的缺点</strong>: - <strong>资源占用大</strong>: - 由于虚拟机是模拟出一套 <strong>完整系统</strong>，包含众多系统级别的文件和库，运行也需要占用一部分资源，单单启动一个空的虚拟机，可能就要占用 100+MB 的内存了。 - <strong>启动缓慢</strong>: - 同样是由于完整系统，在启动过程中就需要运行各种系统应用和步骤，也就是跟我们平时启动电脑一样的耗时。 - <strong>冗余步骤多</strong>: - 系统有许多内置的系统操作，例如用户登录，系统检查等等，有些场景其实我们要的只是一个隔离的环境，其实也就是说，虚拟机对部分需求痛点来说，其实是有点过重的。</p></li></ul><h3 id="linux-容器"><a aria-hidden="true" href="#linux-容器"><span class="icon icon-link"></span></a>Linux 容器</h3><ul><li>Linux 中的一项虚拟化技术，称为 Linux 容器技术(LXC)。</li><li>它在 <strong>进程层面</strong> 模拟出一套隔离的环境配置，但并没有模拟硬件和完整的操作系统。因此它完全规避了传统虚拟机的缺点，在启动速度，资源利用上远远优于虚拟机；</li></ul><p>Docker 就是基于 Linux 容器的一种上层封装，提供了更为简单易用的 API 用于操作 Docker，属于一种 <strong>容器解决方案</strong>。</p><h2 id="概念"><a aria-hidden="true" href="#概念"><span class="icon icon-link"></span></a>概念</h2><p>在 Docker 中，有三个核心的概念:</p><h3 id="镜像-image"><a aria-hidden="true" href="#镜像-image"><span class="icon icon-link"></span></a>镜像 (Image)</h3><ul><li>从原理上说，镜像属于一种 <strong>root 文件系统</strong>，包含了一些系统文件和环境配置等，可以将其理解成一套 <strong>最小操作系统</strong>。为了让镜像轻量化和可移植，Docker 采用了 <strong>Union FS 的分层存储模式</strong>。将文件系统分成一层一层的结构，逐步从底层往上层构建，每层文件都可以进行继承和定制。这里从前端的角度来理解: <strong>镜像就类似于代码中的 class，可以通过继承与上层封装进行复用</strong>。</li><li>从外层系统看来，一个镜像就是一个 Image <strong>二进制文件</strong>，可以任意迁移，删除，添加；</li></ul><h3 id="容器-container"><a aria-hidden="true" href="#容器-container"><span class="icon icon-link"></span></a>容器 (Container)</h3><ul><li>镜像是一份静态文件系统，无法进行运行时操作，就如<code>class</code>，如果我们不进行实例化时，便无法进行操作和使用。因此 <strong>容器可以理解成镜像的实例</strong>，即 <code>new 镜像()</code>，这样我们便可以创建、修改、操作容器；一旦创建后，就可以简单理解成一个轻量级的操作系统，可以在内部进行各种操作，例如运行 node 应用，拉取 git 等；</li><li>基于镜像的分层结构，容器是 <strong>以镜像为基础底层</strong>，在上面封装了一层 <strong>容器的存储层</strong>； 1. 存储空间的生命周期与容器一致； 2. 该层存储层会随着容器的销毁而销毁； 3. 尽量避免往容器层写入数据；</li><li>容器中的数据的持久化管理主要由两种方式: - <strong>数据卷 (Volume)</strong>: 一种可以在多个容器间共享的特殊目录，其处于容器外层，并不会随着容器销毁而删除； - <strong>挂载主机目录</strong>: 直接将一个主机目录挂载到容器中进行写入；</li></ul><h3 id="仓库-repository"><a aria-hidden="true" href="#仓库-repository"><span class="icon icon-link"></span></a>仓库 (Repository)</h3><ul><li>为了便于镜像的使用，Docker 提供了类似于 git 的仓库机制，在仓库中包含着各种各样版本的镜像。官方服务是 Docker Hub；</li><li>可以快速地从仓库中拉取各种类型的镜像，也可以基于某些镜像进行自定义，甚至发布到仓库供社区使用；</li></ul><h2 id="环境安装"><a aria-hidden="true" href="#环境安装"><span class="icon icon-link"></span></a>环境安装</h2><h3 id="centos安装"><a aria-hidden="true" href="#centos安装"><span class="icon icon-link"></span></a>CentOS安装</h3><p>移除旧的版本：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-selinux \
                  docker-engine-selinux \
                  docker-engine
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> yum remove docker </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-client </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-client-latest </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-common </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-latest </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-latest-logrotate </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-logrotate </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-selinux </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-engine-selinux </span><span class="token punctuation">\</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  docker-engine</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>安装一些必要的系统工具：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> yum </span><span class="token function">install</span><span class="token plain"> -y yum-utils device-mapper-persistent-data lvm2</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>添加软件源信息：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>更新 yum 缓存：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo yum makecache fast
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> yum makecache fast</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>安装 Docker-ce：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo yum -y install docker-ce
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> yum -y </span><span class="token function">install</span><span class="token plain"> docker-ce</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>启动 Docker 后台服务</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ sudo systemctl start docker
" data-status="copy"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">sudo</span><span class="token plain"> systemctl start docker</span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last Update: ">7/29/2020, 3:02:30 PM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
